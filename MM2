if not game:IsLoaded() then game.Loaded:Wait() end

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")
local workspace = game:GetService("Workspace")
local player = Players.LocalPlayer

-- Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ UI
if player.PlayerGui:FindFirstChild("MM2_UI") then
    player.PlayerGui.MM2_UI:Destroy()
end

-- Ğ¡Ñ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
local autoFarmEnabled = false
local autoResetEnabled = false
local disableRenderEnabled = false
local antiAFKUsed = false

-- Icy Blue UI (ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù…)
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "Dark On YT"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 320, 0, 260)
frame.Position = UDim2.new(0.5, -160, 0.5, -130)
frame.BackgroundColor3 = Color3.fromRGB(10, 10, 30) -- Ø£Ø²Ø±Ù‚/Ø¨Ù†ÙØ³Ø¬ÙŠ Ø¯Ø§ÙƒÙ†
frame.BackgroundTransparency = 0.1
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.fromRGB(0, 150, 255) -- Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ Ù„Ù„Ø­ÙˆØ§Ù
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

-- ğŸ§Šâ„ï¸ Icy Blue Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚ (ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ±)
local gradient = Instance.new("UIGradient", frame)
gradient.Rotation = 90
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0.00, Color3.fromRGB(0, 100, 150)), -- Ø£Ø²Ø±Ù‚ Ø¨Ø­Ø±ÙŠ
    ColorSequenceKeypoint.new(0.25, Color3.fromRGB(50, 150, 200)), -- Ø£Ø²Ø±Ù‚ Ù…ØªÙˆØ³Ø·
    ColorSequenceKeypoint.new(0.50, Color3.fromRGB(150, 200, 255)), -- Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ Ø«Ù„Ø¬ÙŠ
    ColorSequenceKeypoint.new(0.75, Color3.fromRGB(180, 220, 255)), -- Ø£Ø²Ø±Ù‚ Ø¬Ù„ÙŠØ¯ÙŠ ÙØ§ØªØ­
    ColorSequenceKeypoint.new(1.00, Color3.fromRGB(255, 255, 255)) -- Ø£Ø¨ÙŠØ¶ Ø«Ù„Ø¬ÙŠ
})

frame.Size = UDim2.new(0, 0, 0, 0)
TweenService:Create(frame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0, 320, 0, 260)
}):Play()

-- ğŸ¥¶â„ï¸ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø«Ù„Ø¬ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„ÙŠÙ‚Ø·ÙŠÙ† (ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ±)
local IcyIcon = Instance.new("Frame", frame)
IcyIcon.Name = "IcyIcon" -- ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø«Ù„Ø¬
IcyIcon.Size = UDim2.new(0, 42, 0, 42)
IcyIcon.Position = UDim2.new(0.82, 0, 0.04, 0)
IcyIcon.BackgroundColor3 = Color3.fromRGB(0, 150, 255) -- Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­
IcyIcon.BorderSizePixel = 0
Instance.new("UICorner", IcyIcon).CornerRadius = UDim.new(1, 0)

-- ØªØºÙŠÙŠØ± Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ø¥Ù„Ù‰ Ø´ÙƒÙ„ Ø«Ù„Ø¬ÙŠ (Ø£Ø¨ÙŠØ¶)
for i = 1, 2 do
    local crystal = Instance.new("Frame", IcyIcon)
    crystal.Size = UDim2.new(0, 6, 0, 6)
    crystal.Position = UDim2.new(i == 1 and 0.3 or 0.65, 0, 0.3, 0)
    crystal.BackgroundColor3 = Color3.fromRGB(255, 255, 255) -- Ø£Ø¨ÙŠØ¶
    Instance.new("UICorner", crystal).CornerRadius = UDim.new(1, 0)
end

local crystalCenter = Instance.new("Frame", IcyIcon)
crystalCenter.Size = UDim2.new(0.5, 0, 0.2, 0)
crystalCenter.Position = UDim2.new(0.25, 0, 0.65, 0)
crystalCenter.BackgroundColor3 = Color3.fromRGB(255, 255, 255) -- Ø£Ø¨ÙŠØ¶
Instance.new("UICorner", crystalCenter)

-- ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ
local angle = 0
RunService.RenderStepped:Connect(function()
    angle += 0.8
    IcyIcon.Rotation = math.sin(angle/20) * 8 -- ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ø¦Ù† Ø¥Ù„Ù‰ IcyIcon
end)

-- Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, -50, 0, 42)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Text = "ğŸ§Š Dark On YT | Icy Blue ğŸ¥¶" -- ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
title.TextColor3 = Color3.fromRGB(150, 220, 255) -- Ø£Ø²Ø±Ù‚ Ø«Ù„Ø¬ÙŠ ÙØ§ØªØ­
title.Font = Enum.Font.FredokaOne
title.TextSize = 20
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextStrokeTransparency = 0.3
title.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)

-- ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ
local closeBtn = Instance.new("TextButton", frame)
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -35, 0, 6)
closeBtn.Text = "X"
closeBtn.BackgroundColor3 = Color3.fromRGB(200, 60, 60) -- Ø£Ø­Ù…Ø± (ØªÙ… Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„ÙŠÙ‡ Ù„ÙŠÙƒÙˆÙ† Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ ØªÙ‚Ù„ÙŠØ¯ÙŠ)
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 16
Instance.new("UICorner", closeBtn)

-- Ğ¤Ğ¾Ğ½ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
local contentBg = Instance.new("Frame", frame)
contentBg.Size = UDim2.new(0.92, 0, 0.76, 0)
contentBg.Position = UDim2.new(0.04, 0, 0.18, 0)
contentBg.BackgroundColor3 = Color3.fromRGB(15, 15, 35) -- Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ†/Ø¨Ù†ÙØ³Ø¬ÙŠ
contentBg.BackgroundTransparency = 0.4
Instance.new("UICorner", contentBg)

local content = Instance.new("Frame", contentBg)
content.Size = UDim2.new(1, -10, 1, -10)
content.Position = UDim2.new(0, 5, 0, 5)
content.BackgroundTransparency = 1

-- Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ĞµĞ¹
local function createToggle(yPos, labelText, defaultValue, callback)
    local label = Instance.new("TextLabel", content)
    label.Size = UDim2.new(0.7, 0, 0, 30)
    label.Position = UDim2.new(0.05, 0, 0, yPos)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(180, 220, 255) -- Ø£Ø²Ø±Ù‚ Ø«Ù„Ø¬ÙŠ ÙØ§ØªØ­ Ù„Ù„Ù†Øµ
    label.Font = Enum.Font.GothamSemibold
    label.TextSize = 16
    label.TextXAlignment = Enum.TextXAlignment.Left

    local toggleBg = Instance.new("TextButton", content)
    toggleBg.Size = UDim2.new(0, 50, 0, 25)
    toggleBg.Position = UDim2.new(0.78, 0, 0, yPos + 2)
    -- ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ø´Ø·
    toggleBg.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 150, 255) or Color3.fromRGB(100, 100, 100)
    toggleBg.Text = ""
    toggleBg.AutoButtonColor = false
    Instance.new("UICorner", toggleBg).CornerRadius = UDim.new(1, 0)

    local toggleKnob = Instance.new("Frame", toggleBg)
    toggleKnob.Size = UDim2.new(0, 20, 0, 20)
    toggleKnob.Position = defaultValue and UDim2.new(1, -22, 0, 2) or UDim2.new(0, 2, 0, 2)
    toggleKnob.BackgroundColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", toggleKnob).CornerRadius = UDim.new(1, 0)

    toggleBg.MouseButton1Click:Connect(function()
        defaultValue = not defaultValue
        local pos = defaultValue and UDim2.new(1, -22, 0, 2) or UDim2.new(0, 2, 0, 2)
        -- ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ø´Ø·
        local color = defaultValue and Color3.fromRGB(0, 150, 255) or Color3.fromRGB(100, 100, 100)
        TweenService:Create(toggleKnob, TweenInfo.new(0.25), { Position = pos }):Play()
        TweenService:Create(toggleBg, TweenInfo.new(0.25), { BackgroundColor3 = color }):Play()
        callback(defaultValue)
    end)
end

createToggle(10, "ğŸ§Š Auto Farm Coins", autoFarmEnabled, function(value) autoFarmEnabled = value end)
createToggle(40, "ğŸ’§ Auto Reset", autoResetEnabled, function(value) autoResetEnabled = value end)
createToggle(70, "ğŸŒ«ï¸ Disable Render", disableRenderEnabled, function(value)
    disableRenderEnabled = value
    RunService:Set3dRenderingEnabled(not disableRenderEnabled)
end)

-- Anti-AFK
local afkBtn = Instance.new("TextButton", content)
afkBtn.Size = UDim2.new(0.9, 0, 0, 32)
afkBtn.Position = UDim2.new(0.05, 0, 0, 110)
-- ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø²Ø± ØºÙŠØ± Ø§Ù„Ù†Ø´Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ø«Ù„Ø¬ÙŠ
afkBtn.BackgroundColor3 = antiAFKUsed and Color3.fromRGB(70, 160, 70) or Color3.fromRGB(0, 150, 255)
afkBtn.Text = antiAFKUsed and "Anti-AFK Active" or "Enable Anti-AFK"
afkBtn.TextColor3 = Color3.new(1, 1, 1)
afkBtn.Font = Enum.Font.GothamBold
afkBtn.TextSize = 15
Instance.new("UICorner", afkBtn)

afkBtn.MouseButton1Click:Connect(function()
    if not antiAFKUsed then
        antiAFKUsed = true
        afkBtn.Text = "â„ï¸ Anti-AFK Active"
        afkBtn.BackgroundColor3 = Color3.fromRGB(70, 160, 70) -- ØªÙ… Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø®Ø¶Ø± Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø©
        loadstring(game:HttpGet("https://pastebin.com/raw/bwP4bmed"))()
    end
end)

-- Ğ’Ñ€ĞµĞ¼Ñ Ğ² Ğ¸Ğ³Ñ€Ğµ
local startTime = tick()
local playTimeLabel = Instance.new("TextLabel", content)
playTimeLabel.Size = UDim2.new(0.9, 0, 0, 28)
playTimeLabel.Position = UDim2.new(0.05, 0, 0, 155)
playTimeLabel.BackgroundTransparency = 1
playTimeLabel.Text = "â³ time in game: 0d 0h 0m 0s"
playTimeLabel.TextColor3 = Color3.fromRGB(180, 220, 255) -- Ø£Ø²Ø±Ù‚ Ø«Ù„Ø¬ÙŠ ÙØ§ØªØ­
playTimeLabel.Font = Enum.Font.GothamBold
playTimeLabel.TextSize = 14
playTimeLabel.TextXAlignment = Enum.TextXAlignment.Left

task.spawn(function()
    while true do
        local delta = math.floor(tick() - startTime)
        local d, h, m, s = math.floor(delta/86400), math.floor(delta%86400/3600), math.floor(delta%3600/60), delta%60
        playTimeLabel.Text = string.format("â³ time in game: %dd %02dh %02dm %02ds", d, h, m, s)
        task.wait(1)
    end
end)

-- ÙˆØ¸ÙŠÙØ© Ø³Ø­Ø¨ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù… ÙŠØªØºÙŠØ±)
local dragging, dragInput, dragStart, startPos
local function updateFramePosition(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

frame.InputBegan:Connect(function(input)
    if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position

        if input.UserInputType == Enum.UserInputType.Touch then
            local connection
            connection = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                    connection:Disconnect()
                else
                    updateFramePosition(input)
                end
            end)
        end

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        updateFramePosition(input)
    end
end)

-- Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ/Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ
local isHidden = false
closeBtn.MouseButton1Click:Connect(function()
    isHidden = not isHidden
    local newSize = isHidden and UDim2.new(0, 320, 0, 42) or UDim2.new(0, 320, 0, 260)
    TweenService:Create(frame, TweenInfo.new(0.3), { Size = newSize }):Play()
    contentBg.Visible = not isHidden
    IcyIcon.Visible = not isHidden -- ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ø¦Ù†
end)

-- Auto Farm Coins (Ù„Ù… ÙŠØªØºÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚)
local CoinCollected = ReplicatedStorage.Remotes.Gameplay.CoinCollected
local RoundStart = ReplicatedStorage.Remotes.Gameplay.RoundStart
local RoundEnd = ReplicatedStorage.Remotes.Gameplay.RoundEndFade

local farming = false
local bag_full = false
local resetting = false
local start_position = nil

player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

local function getCharacter() return player.Character or player.CharacterAdded:Wait() end
local function getHRP() return getCharacter():WaitForChild("HumanoidRootPart") end

CoinCollected.OnClientEvent:Connect(function(_, current, max)
    if current == max and not resetting and autoResetEnabled then
        resetting = true
        bag_full = true
        local hrp = getHRP()
        if start_position then
            local tween = TweenService:Create(hrp, TweenInfo.new(2, Enum.EasingStyle.Linear), {CFrame = start_position})
            tween:Play()
            tween.Completed:Wait()
        end
        task.wait(0.5)
        player.Character.Humanoid.Health = 0
        player.CharacterAdded:Wait()
        task.wait(1.5)
        resetting = false
        bag_full = false
    end
end)

RoundStart.OnClientEvent:Connect(function()
    farming = true
    start_position = getHRP().CFrame
end)

RoundEnd.OnClientEvent:Connect(function()
    farming = false
end)

local function get_nearest_coin()
    local hrp = getHRP()
    local closest, dist = nil, math.huge
    for _, m in pairs(workspace:GetChildren()) do
        if m:FindFirstChild("CoinContainer") then
            for _, coin in pairs(m.CoinContainer:GetChildren()) do
                if coin:IsA("BasePart") and coin:FindFirstChild("TouchInterest") then
                    local d = (hrp.Position - coin.Position).Magnitude
                    if d < dist then closest, dist = coin, d end
                end
            end
        end
    end
    return closest, dist
end

task.spawn(function()
    while true do
        if autoFarmEnabled and farming and not bag_full then
            local coin, dist = get_nearest_coin()
            if coin then
                local hrp = getHRP()
                if dist > 150 then
                    hrp.CFrame = coin.CFrame
                else
                    local tween = TweenService:Create(hrp, TweenInfo.new(dist / 20, Enum.EasingStyle.Linear), {CFrame = coin.CFrame})
                    tween:Play()
                    repeat task.wait() until not coin:FindFirstChild("TouchInterest") or not farming or not autoFarmEnabled
                    tween:Cancel()
                end
            end
        end
        task.wait(0.2)
    end
end)
